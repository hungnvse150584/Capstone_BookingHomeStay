<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignalR Notification Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.1/signalr.min.js"></script>
</head>
<body>
    <h1>SignalR Notification Test</h1>
    <div id="notificationList"></div>

    <script>
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("https://localhost:7221/notificationHub?accountId=17d8bdf8-2296-42d2-887a-c335f87483c0")
            .configureLogging(signalR.LogLevel.Information)
            .build();

        connection.on("ReceiveNotification", (accountId, title, message, notificationId, createAt, isRead, typeNotify) => {
            const notificationDiv = document.createElement("div");
            notificationDiv.innerHTML = `
                    <h3>${title}</h3>
                    <p>${message}</p>
                    <p>Account ID: ${accountId}</p>
                    <p>Notification ID: ${notificationId}</p>
                    <p>Create At: ${createAt}</p>
                    <p>Is Read: ${isRead}</p>
                    <p>Type Notify: ${typeNotify}</p>
                    <hr/>
                `;
            document.getElementById("notificationList").appendChild(notificationDiv);
        });

        connection.start()
            .then(() => console.log("Connected to SignalR Hub"))
            .catch(err => console.error("Error connecting to SignalR Hub:", err));

        connection.onclose(() => {
            console.log("Connection closed. Attempting to reconnect...");
            setTimeout(() => connection.start(), 5000);
        });
    </script>
</body>
</html>